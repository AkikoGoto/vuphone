<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Wreck Watch Map</title>
<script src="/jquery/jquery-1.3.2.js type="text/javascript" ></script>
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;sensor=false&amp;key=ABQIAAAABWCNt87qa4B0xMt7qCbeOhSABSC43zt-uuIUMpKOuOUAYe5MURQqhVVP2yksSKanPly6HhZO9cGscA" type="text/javascript"></script>
    <script type="text/javascript">

    function init() {
      if (GBrowserIsCompatible()) {
        this.map = new GMap2(document.getElementById("map_canvas"));
        this.map.setCenter(new GLatLng(36.19, -86.78), 13);
        getData();
        window.setInterval("getData()", 30000);
      }
    }

    function getData(){
        var GLatLngBounds bnds = this.map.getBounds();
        $.getJSON("http://localhost:8081/wreckwatch/map/?type=bmap&nelat="+bnds.getNorthEast().lat()+"&swlat="+bnds.getSouthWest().lat()+
                "&nelon="+bnds.getNorthEast().lon()+"&swlon="+bnds.getSouthWest().lon(),callback);
	
    }

    function callback(json){
        this.map.clearOverlays();
        $.each(json.list.route, function(i, item){
            $.each(route.route_.waypoint, function(j, item){
                this.map.addOverlay(new GMarker(new GLatLng(item.latitude_, item.longitude_)));
            }
        }
        
    }
    

    </script>
  </head>
  <body onload="init()" onunload="GUnload()" style="font-family: Arial;border: 0 none;">
    <div id="map_canvas" style="width: 500px; height: 500px"></div>
  </body>
</html>